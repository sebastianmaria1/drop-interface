<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faddy Core</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #000; color: #f3ba2f; font-family: monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; padding: 10px; box-sizing: border-box; }
        .box { border: 2px solid #f3ba2f; padding: 20px; border-radius: 10px; width: 100%; max-width: 400px; background: #111; text-align: center; }
        h1 { margin: 0 0 15px; color: white; font-size: 1.5em; }
        .data-display { background: #222; padding: 15px; border-radius: 5px; margin: 20px 0; font-size: 1.1em; word-break: break-all; border: 1px dashed #444; color: #fff; }
        .btn { padding: 15px; background: #f3ba2f; color: black; border: none; font-weight: bold; width: 100%; cursor: pointer; border-radius: 5px; font-size: 1.1em; margin-top: 10px; }
        .btn:active { opacity: 0.8; }
    </style>
</head>
<body>

    <div class="box">
        <h1>üîê SECURE DROP</h1>
        <div id="status">Esperando datos...</div>
        
        <div id="cardData" class="data-display">---</div>
        
        <button class="btn" onclick="copiar()">COPIAR NUMERO</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // --- L√ìGICA TODOTERRENO ---
        function obtenerDatos() {
            // 1. Intentar leer desde Telegram (Mini App)
            const paramTg = tg.initDataUnsafe.start_param;
            if (paramTg) return paramTg;

            // 2. Intentar leer desde Navegador (Emergency Link)
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('start_param');
        }

        // Ejecutar lectura
        const rawData = obtenerDatos();

        if (rawData) {
            try {
                const decoded = decodeURIComponent(rawData);
                document.getElementById('status').innerText = "‚úÖ DATOS RECIBIDOS";
                document.getElementById('status').style.color = "#0f0";
                document.getElementById('cardData').innerText = decoded;
            } catch (e) {
                document.getElementById('cardData').innerText = "Error decodificando";
            }
        } else {
            document.getElementById('status').innerText = "‚ö†Ô∏è Link vac√≠o o expirado";
        }

        function copiar() {
            const texto = document.getElementById('cardData').innerText;
            const numero = texto.split('|')[0]; // Toma solo lo que est√° antes de la barra
            
            navigator.clipboard.writeText(numero).then(() => {
                // Intento de alerta visual
                const btn = document.querySelector('.btn');
                btn.innerText = "¬°COPIADO!";
                setTimeout(() => btn.innerText = "COPIAR NUMERO", 2000);
            }).catch(err => {
                alert("Copia manual: " + numero);
            });
        }
    </script>
</body>
</html>
